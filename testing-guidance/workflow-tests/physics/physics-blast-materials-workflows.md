# Physics Blast Materials Workflows

## Test Approach

*   Verify that the conversion of Blast materials are successful

# Blast Materials Test Workflows

##Project Requirements
Any project that has the following Gems enabled: 
* PhysX 
* Primitive Assets 
* Script Canvas Physics
* NvCloth
* Mesh or Actor with a Cloth data node


**Platforms:**
* Windows
* Linux

**Suggested Time Box:** 30 minutes

| Workflow                                                                                                                                                                                                                                                     | Requests                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Things to Watch For                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Entity Components**<br><br>Verify that the blast family entity components are able to have the blast material assigned to it directly from a library of materials and a simulation can be ran.                                                             | **Prerequisite:**<ul><li>Blast Gem has been enabled and built for the project (AutomatedTesting comes with it enabled)</li><li>A level with at least two entities has been created</li><li>Editor has been opened to the level that contains the entities</ul>**Steps**<ol><li>On the first entity add the Blast Family entity components<ol><li>Blast Family<ul><li>Blast Asset<ul><li>Desired Test Asset</li></ul><li>Choose Desired Blast Material</li></ul></li><li>Blast Family Mesh Data</li></li></ol><li>On the second entity add the following physx components</li><ul><li>PhysX Collider</li><li>PhysX Rigid Body</li><ul><li>Gravity Enabled = True</li></ul><li>Mesh (to provide visibility to the object)</li><ul><li>Sphere.fbx or any other</li></ul></ul><li>Orient the scene so that the the entity with the PhysX collider will collide with the entity that contains blast family entity</li><li>Enter Game Mode (Ctrl + G) or Load Level in Game Launcher</ol>                                                                                                                                                                                             | <ul><li>User can assign the blast materials to the component</li><li>Editor and runtimes do not crash</li><li>No errors are displayed in the console</li><li>Simulation Runs</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Verify Conversion Tool Works**<br><br>There will be 2 commands for conversion. Both will be an Editor console command:<br><ul><li>One to convert the blast material assets</li><li>One to convert the Prefabs that utilize blast material assets</li></ul> | **Prerequisite:**<ul><li>Unconverted material library asset and prefab. Extract it in your project: [BlastOldAssets.zip](testassets/BlastOldAssets.zip)</li></ul>**Steps**<ol><li>Run Asset Processor and wait until all assets have been processed</li><li>Open Editor. Do not open any level, just close the "Welcome to O3DE" screen.</li><li>Open Console: Tools > Console</li><li>**Convert old blast material library asset**:</li><ol><li>Enter the following command on the console: "ed\_blastConvertMaterialLibrariesIntoIndividualMaterials"</li><li>Expected result:</li><ul><li>File BlastMaterialLIbrary.blastmaterial was deleted.</li><li>The following files were generated: BlastMaterial1.blastmaterial, BlastMaterial2.blastmaterial, BlastMaterial3.blastmaterial</li></ul></ol><li>**Fix prefabs that utilize old blast material library**:</li><ol><li>Enter the following command on the console: "ed\_blastFixPrefabsWithBlastComponentLegacyMaterials"  <br>        Note: it might take a few seconds since it's checking all prefabs in the project.</li><li>Expected result:</li><ul><li>Reports that BlastTest.prefab was fixed</li></ul></ol></ol> | <ul><li>Check material properties were converted correctly by opening the 3 .blastmaterial one by one with Asset Editor (Tools > Asset Editor) and check its health property. BlastMaterial1 should have health value of 1, BlastMaterial2 health 2 and BlastMaterial3 health 3.</li><li>Check prefab was fixed correctly by opening a level and dragging and dropping BlastTest.prefab into it. In Entity Outliner (Tools > Entity Outliner) edit the prefab and select its inner entity. In Entity Inspector (Tools > Entity Inspector) it must have a Blast Family component and its Blast Material field should be "blastmaterial2".</li></ul> |
| **Verify** **Unconverted Blast Material Using a Level**                                                                                                                                                                                                      | **Prerequisite:**<ul><li>Unconverted Asset has been extracted to your project and processed by the asset processor: [blastdamagematerial.zip](testassets/blastdamagematerial.zip)</li></ul>**Steps**<ol><li>Execute the **Entity Components** workflow using the asset(s) found in the provided zip</li><ol>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <ul><li>Editor and runtimes do not crash</li><li>Entity with a blast family component that utilizes an old blast material uses the default material instead and a message appears in the console log letting the user know as much when a material is assigned</li></ul>                                                                                                                                                                                                                                                                                                                                                                           |
| **Verify a Blast Component with no Material Assigned to it**                                                                                                                                                                                                 | **Prerequisite:**<ul><li>Blast Gem has been enabled and built for the project (AutomatedTesting comes with it enabled)</li><li>A level with at least two entities has been created</li><li>Editor has been opened to the level that contains the entities</li></ul>**Steps**<ol><li>On the first entity add the Blast Family entity components</li><ul><li>Blast Family</li><ul><li>Blast Asset</li><ul><li>Desired Test Asset</li></ul><li>Leave Blast Material Blank</li></ul><li>Blast Family Mesh Data</li></ul><li>On the second entity add the following physx components</li><ul><li>PhysX Collider</li><li>PhysX Rigid Body</li><ul><li>Gravity Enabled = True</li></ul><li>Mesh (to provide visibility to the object)</li><ul><li>Sphere.fbx or any other</li></ul></ul><li>Orient the scene so that the the entity with the PhysX collider will collide with the entity that contains blast family entity</li><li>Enter Game Mode (Ctrl + G) or Load Level in Game Launcher</li></li>                                                                                                                                                                                 | <ul><li>Editor and runtimes do not crash</li><li>No errors are displayed in the console</li><li>Default values of the material are used</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
